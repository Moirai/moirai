cmake_minimum_required(VERSION 2.8.3)
project(opt_camera)

find_package(catkin REQUIRED COMPONENTS sensor_msgs driver_base image_proc dynamic_reconfigure camera_calibration_parsers compressed_image_transport cv_bridge rospack)
find_package(OpenCV REQUIRED)

# include files
include_directories(${catkin_INCLUDE_DIRS})
include_directories(SYSTEM ${OpenCV_INCLUDE_DIRS})
include_directories(src/opt_nm33_uvc)
include_directories(${CATKIN_DEVEL_PREFIX}/include/opt_camera)


# create nm33_node
add_executable(nm33_node src/nm33_node.cpp src/opt_nm33_uvc/opt_nm33_camera.cpp src/opt_nm33_uvc/opt_nm33_uvc.cpp)
#add_dependencies(${PROJECT_NAME} ${PROJECT_NAME}_gencfg)
target_link_libraries(nm33_node ${catkin_LIBRARIES} ${OpenCV_LIBRARIES})
install(TARGETS nm33_node
        DESTINATION ${PROJECT_SOURCE_DIR}/bin
#        DESTINATION ${CATKIN_PCKAGE_BIN_DESTINATION}
)

# create init_xu_register 
add_executable(init_xu_register src/opt_nm33_uvc/init_xu_register.cpp src/opt_nm33_uvc/opt_nm33_uvc.cpp)
#target_link_libraries(nm33_node ${catkin_LIBRARIES} ${OpenCV_LIBRARIES})
target_link_libraries(nm33_node ${OpenCV_LIBRARIES})
install(TARGETS init_xu_register
        DESTINATION ${PROJECT_SOURCE_DIR}/bin
#        DESTINATION ${CATKIN_PCKAGE_LIB_DESTINATION}
)

# create _non_std_uvc
add_executable(nm33_node_non_std_uvc src/nm33_node.cpp src/opt_nm33_uvc/opt_nm33_camera.cpp src/opt_nm33_uvc/opt_nm33_uvc.cpp)
target_link_libraries(nm33_node_non_std_uvc ${catkin_LIBRARIES} ${OpenCV_LIBRARIES})
set_target_properties(nm33_node_non_std_uvc PROPERTIES COMPILE_FLAGS -DNON_STD_UVC=1)
install(TARGETS nm33_node_non_std_uvc
       DESTINATION ${PROJECT_SOURCE_DIR}/bin
#        DESTINATION ${CATKIN_PCKAGE_BIN_DESTINATION}
)
add_executable(init_xu_register_non_std_uvc src/opt_nm33_uvc/init_xu_register.cpp src/opt_nm33_uvc/opt_nm33_uvc.cpp)
target_link_libraries(init_xu_register_non_std_uvc ${OpenCV_LIBRARIES})
set_target_properties(init_xu_register_non_std_uvc PROPERTIES COMPILE_FLAGS -DNON_STD_UVC=1)
install(TARGETS init_xu_register_non_std_uvc
       DESTINATION ${PROJECT_SOURCE_DIR}/bin
#        DESTINATION ${CATKIN_PCKAGE_LIB_DESTINATION}
)



# generate the dynamic_reconfigure config file   
#generate_dynamic_reconfigure_options(cfg/OptNM33CameraConfig.cfg)
generate_dynamic_reconfigure_options(cfg/OptNM33Camera.cfg)

# install(DIRECTORY include ${PROJECT_NAME}/src/opt_nm33_uvc
#         DESTINATION ${CATKIN_PACKAGE_INCLUDE_DESTINATION}
# #        DESTINATION /home/ysuzuki/moirai-ws/temp
#  )


# define the project                                                                                              
catkin_package(
#   INCLUDE_DIRS src/opt_nm33_uvc
   INCLUDE_DIRS include #opt_camera/include
   LIBRARIES ${PROJECT_NAME}
   CATKIN-DEPENDS sensor_msgs driver_base image_proc dynamic_reconfigure camera_calibration_parsers compressed_image_transport cv_bridge
   DEPENDS opencv
)

# test
#catkin_add_gtest()    

